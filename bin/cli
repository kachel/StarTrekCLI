#!/usr/bin/env ruby

require 'bundler/setup'
require 'StarTrekCLI'
require 'optparse'
require 'rb-readline'

# stateless interface
instructions = {}

parser = OptionParser.new do |opts|
  opts.banner = "Usage: example.rb [instructions]"

  # opts.on("-v", "--[no-]verbose", "Run verbosely") do |v|
  #   instructions[:verbose] = v
  # end

  opts.on("--list-series", "List series") do |bool|
    # either true or false hence the |bool|
    instructions[:list_series] = bool
  end

  opts.on("--list-seasons SERIES", "List seasons for a series") do |series|
  # list seasons *for* this series
    instructions[:list_seasons] = series
  end

  # list episodes for a season
  opts.on("--list-episodes SERIES:SEASON", "List episodes for a season") do |spec|
    raise "Do not forget your colon. You typed '#{spec}'" unless spec.include?(":")
    splitter = spec.split(":")
    instructions[:list_episodes] = splitter
  end

end # parser

parser.parse!

if instructions[:list_series]
  puts "All Star Trek series:"
  StarTrekCLI::Controller.new.list_series

elsif instructions[:list_seasons]
  puts "Here are the seasons for #{instructions[:list_seasons]}:"
  StarTrekCLI::Controller.new.list_seasons(instructions[:list_seasons])

elsif instructions[:list_episodes]
  puts "Here are the episodes:"
  StarTrekCLI::Controller.new.list_episodes(splitter[0], splitter[1])

else
  puts "TODO print"
end



# TODO: print help if no arguments
